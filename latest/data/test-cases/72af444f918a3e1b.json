{"uid":"72af444f918a3e1b","name":"test_user_security[/api/cards/add_ewallet-case4]","fullName":"tests.test_03_user_security#test_user_security","historyId":"1b8b7db67d90f3f33f4f2178f651f755","time":{"start":1766395518651,"stop":1766395518651,"duration":0},"status":"broken","statusMessage":"KeyError: 'data'","statusTrace":"raw_client = <utils.api_client.ApiClient object at 0x0000028E88989A20>\n\n    @pytest.fixture(scope=\"session\")\n    def auth_client(raw_client):\n        \"\"\"\n        全局认证客户端\n        - 登录成功：写入 token + USER_ID\n        - 失败：skip 所有依赖它的用例\n        \"\"\"\n    \n        login_cases = load_yaml(\"data/register.yaml\")\n        login_case = login_cases[0]\n        login_req = login_case[\"request\"]\n    \n        resp = raw_client.request(\n            method=\"POST\",\n            url=\"/auth/register\",\n            params={\"force_no_encrypt\": \"567f9c9a-28cf-4096-b540-e428f40a1e74-jh82\"},\n            json_body=login_req,\n        )\n    \n        if not resp.response or resp.response.status_code != 200:\n            logging.warning(\"❌ 登录接口 HTTP 失败，跳过所有依赖登录的用例\")\n    \n        biz = resp.biz_json or {}\n        token = biz.get(\"token\")\n    \n        if not token:\n            logging.warning(\"❌ 登录失败（未返回 token），跳过所有依赖登录的用例\")\n    \n        raw_client.set_token(token)\n        logging.info(\"✅ 登录成功，token 已写入\")\n    \n        # ===== 获取用户信息 =====\n        profile = raw_client.request(\n            method=\"POST\",\n            url=\"/api/users/i/info\",\n            params={\"force_no_encrypt\": \"567f9c9a-28cf-4096-b540-e428f40a1e74-jh82\"},\n            json_body={}\n        )\n    \n        if not profile.biz_json:\n            pytest.skip(\"❌ 获取用户信息失败，跳过后续用例\")\n    \n>       user_id = profile.biz_json[\"data\"][\"id\"]\nE       KeyError: 'data'\n\ntests\\conftest.py:217: KeyError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"raw_client","time":{"start":1766395516904,"stop":1766395516919,"duration":15},"status":"passed","steps":[],"attachments":[],"parameters":[],"hasContent":false,"attachmentsCount":0,"attachmentStep":false,"shouldDisplayMessage":false,"stepsCount":0},{"name":"pytestconfig","time":{"start":1766395516904,"stop":1766395516904,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"hasContent":false,"attachmentsCount":0,"attachmentStep":false,"shouldDisplayMessage":false,"stepsCount":0},{"name":"auth_client","time":{"start":1766395517551,"stop":1766395518495,"duration":944},"status":"broken","statusMessage":"KeyError: 'data'\n","statusTrace":"  File \"D:\\Python\\Python310\\lib\\site-packages\\pluggy\\_callers.py\", line 38, in run_old_style_hookwrapper\n    res = yield\n  File \"D:\\Python\\Python310\\lib\\site-packages\\pluggy\\_callers.py\", line 139, in _multicall\n    teardown.throw(exception)\n  File \"D:\\Python\\Python310\\lib\\site-packages\\_pytest\\setuponly.py\", line 36, in pytest_fixture_setup\n    return (yield)\n  File \"D:\\Python\\Python310\\lib\\site-packages\\pluggy\\_callers.py\", line 121, in _multicall\n    res = hook_impl.function(*args)\n  File \"D:\\Python\\Python310\\lib\\site-packages\\_pytest\\fixtures.py\", line 1202, in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n  File \"D:\\Python\\Python310\\lib\\site-packages\\_pytest\\fixtures.py\", line 915, in call_fixture_func\n    fixture_result = fixturefunc(**kwargs)\n  File \"D:\\PycharmProjects\\23pg-api-test\\tests\\conftest.py\", line 217, in auth_client\n    user_id = profile.biz_json[\"data\"][\"id\"]\n","steps":[],"attachments":[],"parameters":[],"hasContent":true,"attachmentsCount":0,"attachmentStep":false,"shouldDisplayMessage":true,"stepsCount":0}],"afterStages":[],"labels":[{"name":"feature","value":"用户安全模块"},{"name":"parentSuite","value":"tests"},{"name":"suite","value":"test_03_user_security"},{"name":"host","value":"DESKTOP-1OGQ5RE"},{"name":"thread","value":"24988-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_03_user_security"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"case","value":"{'desc': '取款账户_USDT', 'request': {'method': 'POST', 'url': '/api/cards/add_ewallet', 'params': {'force_no_encrypt': '567f9c9a-28cf-4096-b540-e428f40a1e74-jh82'}, 'body': {'type': 'usdtpay', 'account': 'TXGwsvfqgEpu13TY2Rm6xQvbdjJrnc8bYs', 'open_bank': 'TRC20', 'sub_bank': '火币钱包', 'default': True, 'wp_password': '123456', 'email': 'tztz4450@gmail.com', 'verify_code': '123456'}}, 'expected': {'allow_http_codes': [400], 'allow_biz_codes': [40001]}}"},{"name":"case_name","value":"'/api/cards/add_ewallet'"}],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[]}],"tags":[]},"source":"72af444f918a3e1b.json","parameterValues":["{'desc': '取款账户_USDT', 'request': {'method': 'POST', 'url': '/api/cards/add_ewallet', 'params': {'force_no_encrypt': '567f9c9a-28cf-4096-b540-e428f40a1e74-jh82'}, 'body': {'type': 'usdtpay', 'account': 'TXGwsvfqgEpu13TY2Rm6xQvbdjJrnc8bYs', 'open_bank': 'TRC20', 'sub_bank': '火币钱包', 'default': True, 'wp_password': '123456', 'email': 'tztz4450@gmail.com', 'verify_code': '123456'}}, 'expected': {'allow_http_codes': [400], 'allow_biz_codes': [40001]}}","'/api/cards/add_ewallet'"]}